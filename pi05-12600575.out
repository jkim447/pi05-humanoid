‚Üí about to import openpi.training.checkpoints
CHECKPOINTS: start import
CHECKPOINTS: importing orbax...
CHECKPOINTS: orbax imported
‚úì imported checkpoints
04:15:22.521 [I] Running on: iris-hgx-2.stanford.edu                                              (713451:train.py:219)
INFO:2025-10-09 04:15:24,922:jax._src.xla_bridge:925: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
04:15:24.922 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (713451:xla_bridge.py:925)
INFO:2025-10-09 04:15:24,923:jax._src.xla_bridge:925: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
04:15:24.923 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (713451:xla_bridge.py:925)
04:15:27.244 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x1487b4b046d0> (713451:base_pytree_checkpoint_handler.py:334)
04:15:27.244 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x1487b4b046d0> (713451:base_pytree_checkpoint_handler.py:334)
04:15:27.245 [I] [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID. (713451:multihost.py:390)
04:15:27.247 [I] [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers={'assets': <openpi.training.checkpoints.CallbackHandler object at 0x148639699dd0>, 'train_state': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x14863969bb50>, 'params': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1486397e0b90>}, handler_registry=None (713451:checkpoint_manager.py:620)
04:15:27.248 [I] Deferred registration for item: "assets". Adding handler `<openpi.training.checkpoints.CallbackHandler object at 0x148639699dd0>` for item "assets" and save args `<class 'openpi.training.checkpoints.CallbackSave'>` and restore args `<class 'openpi.training.checkpoints.CallbackRestore'>` to `_handler_registry`. (713451:composite_checkpoint_handler.py:234)
04:15:27.248 [I] Deferred registration for item: "train_state". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x14863969bb50>` for item "train_state" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (713451:composite_checkpoint_handler.py:234)
04:15:27.248 [I] Deferred registration for item: "params". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1486397e0b90>` for item "params" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (713451:composite_checkpoint_handler.py:234)
04:15:27.248 [I] Deferred registration for item: "metrics". Adding handler `<orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x14863951d7d0>` for item "metrics" and save args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>` to `_handler_registry`. (713451:composite_checkpoint_handler.py:234)
04:15:27.248 [I] Initialized registry DefaultCheckpointHandlerRegistry({('assets', <class 'openpi.training.checkpoints.CallbackSave'>): <openpi.training.checkpoints.CallbackHandler object at 0x148639699dd0>, ('assets', <class 'openpi.training.checkpoints.CallbackRestore'>): <openpi.training.checkpoints.CallbackHandler object at 0x148639699dd0>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x14863969bb50>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x14863969bb50>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1486397e0b90>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1486397e0b90>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x14863951d7d0>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x14863951d7d0>}). (713451:composite_checkpoint_handler.py:502)
04:15:27.248 [I] orbax-checkpoint version: 0.11.13                                                (713451:abstract_checkpointer.py:35)
04:15:27.249 [I] [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x148622937600> timeout: 7200 secs and primary_host=0 for async checkpoint writes (713451:async_checkpointer.py:170)
04:15:27.251 [I] Found 0 checkpoint steps in /iris/projects/humanoid/openpi/checkpoints/pi05_mixed_kp/co_training_kp (713451:checkpoint_manager.py:1701)
04:15:27.252 [I] [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=5000, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=False, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=AsyncOptions(timeout_secs=7200, barrier_sync_fn=None, post_finalization_callback=None, create_directories_asynchronously=True), multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None, prevent_write_metrics=False), root_directory=/iris/projects/humanoid/openpi/checkpoints/pi05_mixed_kp/co_training_kp: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x14863974fc90> (713451:checkpoint_manager.py:801)
04:15:27.252 [I] Checkpoint directory exists, but does not contain any checkpoints. Aborting resume. (713451:checkpoints.py:69)
wandb: Currently logged in as: jkim2718 (tmp_) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /iris/projects/humanoid/openpi/wandb/run-20251009_041527-rbjf80v3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run co_training_kp
wandb: ‚≠êÔ∏è View project at https://wandb.ai/tmp_/openpi
wandb: üöÄ View run at https://wandb.ai/tmp_/openpi/runs/rbjf80v3
04:15:28.583 [I] Loaded norm stats from /iris/projects/humanoid/openpi/assets/pi05_mixed_kp/egodex (713451:config.py:196)
04:15:28.685 [I] Loaded norm stats from /iris/projects/humanoid/openpi/assets/pi05_mixed_kp/galaxea (713451:config.py:196)
04:15:28.687 [I] data_config: DataConfig(repo_id='egodex', asset_id='egodex', norm_stats={'state': NormStats(mean=array([-0.06352157,  0.14227782,  0.26881284,  0.45910421, -0.46645457,
        0.53958315,  0.54299891,  0.56824952,  0.07262427,  0.03382738,
        0.11007239,  0.31023157,  0.0362317 ,  0.09819902,  0.3401463 ,
        0.03087626,  0.10652699,  0.34842902,  0.01864991,  0.11494368,
        0.35399306, -0.00058273,  0.12304314,  0.3555111 ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ]), std=array([0.07190879, 0.10670202, 0.08256222, 0.29230917, 0.31026933,
       0.31429699, 0.34765774, 0.33940205, 0.37538123, 0.08377123,
       0.12210529, 0.11360677, 0.09180626, 0.1306383 , 0.11922993,
       0.09474635, 0.12915812, 0.11990201, 0.09582409, 0.12804642,
       0.11763563, 0.09487739, 0.12646796, 0.11217478, 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        ]), q01=array([-0.27034635, -0.07647864,  0.03055606, -0.33838078, -0.94783741,
       -0.57528457, -0.44296975, -0.41523846, -0.94008418, -0.21582002,
       -0.1176015 , -0.05976527, -0.23113335, -0.12937861, -0.07554106,
       -0.24252958, -0.1235436 , -0.04075389, -0.25843105, -0.11811677,
       -0.03189126, -0.27353196, -0.11022416, -0.02136359,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ]), q99=array([0.13867276, 0.50470338, 0.41339865, 0.98431844, 0.46279904,
       0.95772349, 0.99254985, 0.99761957, 0.79665535, 0.25119491,
       0.51550516, 0.50615946, 0.26562098, 0.55508075, 0.54399444,
       0.25611439, 0.57716543, 0.55521671, 0.24894364, 0.58905364,
       0.55396963, 0.22701829, 0.59530617, 0.54274013, 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        ])), 'actions': NormStats(mean=array([ 1.34488389e-01, -2.59952918e-02, -7.16139190e-03, -1.25565633e-01,
        5.38062096e-01, -5.72433770e-01,  3.66573781e-02, -5.17637730e-01,
       -1.78506628e-01,  4.81618643e-02, -3.38251740e-02,  7.11444113e-03,
        5.00352383e-02, -3.37209441e-02,  1.94738130e-03,  5.62238172e-02,
       -3.18916366e-02, -3.50678951e-04,  6.85387403e-02, -3.07752751e-02,
       -1.86630758e-03,  8.62058178e-02, -3.07863262e-02, -3.27611575e-03,
        0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
        0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00]), std=array([0.15321214, 0.08699047, 0.06156299, 0.31650251, 0.61812776,
       0.65788645, 0.33277258, 0.64753735, 0.41942361, 0.1017795 ,
       0.10443205, 0.08440314, 0.10877599, 0.11105206, 0.08926608,
       0.11413808, 0.10899913, 0.08921903, 0.12159168, 0.10656328,
       0.08624493, 0.13174999, 0.10411748, 0.08155642, 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        ]), q01=array([-0.06119754, -0.37902792, -0.18278457, -1.11198498, -0.29022322,
       -1.82126504, -0.82518657, -1.84812165, -1.31448051, -0.13242609,
       -0.47274741, -0.21318378, -0.14814817, -0.49318858, -0.22772175,
       -0.14227464, -0.47702141, -0.23286197, -0.1293131 , -0.47197254,
       -0.22961695, -0.10865846, -0.46675156, -0.22081739,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ]), q99=array([0.54428882, 0.15796359, 0.19863284, 0.60229777, 1.76254622,
       0.32061496, 1.13273371, 0.48516809, 0.81388001, 0.42989835,
       0.15756767, 0.3299699 , 0.45798016, 0.17149756, 0.34318458,
       0.47622021, 0.17220992, 0.34137696, 0.50346487, 0.17173861,
       0.33246984, 0.53385237, 0.16726751, 0.3107401 , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        ]))}, repack_transforms=Group(inputs=[RepackTransform(structure={'image': 'image', 'state': 'state', 'actions': 'actions', 'prompt': 'task'})], outputs=()), data_transforms=Group(inputs=(GalaxeaInputs(action_dim=32, model_type=<ModelType.PI05: 'pi05'>), DeltaActions(mask=(True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True))), outputs=(AbsoluteActions(mask=(True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True)), GalaxeaOutputs(action_dim=32))), model_transforms=Group(inputs=[InjectDefaultPrompt(prompt=None), ResizeImages(height=224, width=224), TokenizePrompt(tokenizer=<openpi.models.tokenizer.PaligemmaTokenizer object at 0x1486398b5c10>, discrete_state_input=True), PadStatesAndActions(model_action_dim=32)], outputs=()), use_quantile_norm=True, action_sequence_keys=('actions',), prompt_from_task=True, rlds_data_dir=None, action_space=None, filter_dict_path=None) (713451:data_loader.py:303)
04:16:12.033 [I] local_batch_size: 256                                                            (713451:data_loader.py:432)
successfully loaded cached index: 168152 episodes
going thru: 0
going thru: 1
going thru: 2
going thru: 3
going thru: 4
going thru: 5
going thru: 6
going thru: 7
going thru: 8
going thru: 9
going thru: 10
going thru: 11
going thru: 12
going thru: 13
going thru: 14
going thru: 15
going thru: 16
going thru: 17
going thru: 18
going thru: 19
going thru: 20
going thru: 21
going thru: 22
going thru: 23
going thru: 24
going thru: 25
going thru: 26
going thru: 27
going thru: 28
going thru: 29
going thru: 30
going thru: 31
going thru: 32
going thru: 33
going thru: 34
going thru: 35
going thru: 36
going thru: 37
going thru: 38
going thru: 39
going thru: 40
going thru: 41
going thru: 42
going thru: 43
going thru: 44
going thru: 45
going thru: 46
going thru: 47
going thru: 48
going thru: 49
going thru: 50
going thru: 51
going thru: 52
going thru: 53
going thru: 54
going thru: 55
going thru: 56
going thru: 57
going thru: 58
going thru: 59
going thru: 60
I've loaded and transformed all datasets!
We are normalizing the data
‚Üí about to import openpi.training.checkpoints
CHECKPOINTS: start import
CHECKPOINTS: importing orbax...
CHECKPOINTS: orbax imported
‚úì imported checkpoints
‚Üí about to import openpi.training.checkpoints
CHECKPOINTS: start import
CHECKPOINTS: importing orbax...
CHECKPOINTS: orbax imported
‚úì imported checkpoints
‚Üí about to import openpi.training.checkpoints
CHECKPOINTS: start import
CHECKPOINTS: importing orbax...
CHECKPOINTS: orbax imported
‚úì imported checkpoints
‚Üí about to import openpi.training.checkpoints
CHECKPOINTS: start import
CHECKPOINTS: importing orbax...
CHECKPOINTS: orbax imported
‚úì imported checkpoints
04:18:11.935 [I] Initialized data loader:
[0].images['base_0_rgb']: (256, 224, 224, 3)@float32
[0].images['left_wrist_0_rgb']: (256, 224, 224, 3)@float32
[0].images['right_wrist_0_rgb']: (256, 224, 224, 3)@float32
[0].image_masks['base_0_rgb']: (256,)@bool
[0].image_masks['left_wrist_0_rgb']: (256,)@bool
[0].image_masks['right_wrist_0_rgb']: (256,)@bool
[0].state: (256, 32)@float32
[0].tokenized_prompt: (256, 200)@int32
[0].tokenized_prompt_mask: (256, 200)@bool
[1]: (256, 50, 32)@float32 (713451:train.py:245)
04:18:15.387 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x1487b4b046d0> (713451:base_pytree_checkpoint_handler.py:334)
04:18:15.469 [I] Restoring checkpoint from /iris/projects/humanoid/openpi/.cache/openpi/openpi-assets/checkpoints/pi05_base/params. (713451:checkpointer.py:298)
04:18:24.555 [I] [process=0] /jax/checkpoint/read/bytes_per_sec: 1.4 GiB/s (total bytes: 12.5 GiB) (time elapsed: 9 seconds) (per-host) (713451:base_pytree_checkpoint_handler.py:114)
04:18:24.557 [I] Finished restoring checkpoint in 9.09 seconds from /iris/projects/humanoid/openpi/.cache/openpi/openpi-assets/checkpoints/pi05_base/params. (713451:checkpointer.py:309)
04:18:36.040 [I] Initialized train state:
['PaliGemma']['img']['Transformer']['encoder_norm']['bias'].value: (1152,)@float32
['PaliGemma']['img']['Transformer']['encoder_norm']['scale'].value: (1152,)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['scale'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['scale'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['bias'].value: (27, 4304)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value: (27, 1152, 4304)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value: (27, 4304, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value: (27, 16, 72, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['embedding']['bias'].value: (1152,)@float32
['PaliGemma']['img']['embedding']['kernel'].value: (14, 14, 3, 1152)@float32
['PaliGemma']['img']['head']['bias'].value: (2048,)@float32
['PaliGemma']['img']['head']['kernel'].value: (1152, 2048)@float32
['PaliGemma']['img']['pos_embedding'].value: (1, 256, 1152)@float32
['PaliGemma']['llm']['embedder']['input_embedding'].value: (257152, 2048)@float32
['PaliGemma']['llm']['final_norm']['scale'].value: (2048,)@float32
['PaliGemma']['llm']['final_norm_1']['Dense_0']['bias'].value: (3072,)@float32
['PaliGemma']['llm']['final_norm_1']['Dense_0']['kernel'].value: (1024, 3072)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value: (18, 8, 256, 2048)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['w'].value: (18, 8, 256, 1024)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value: (18, 2, 1, 2048, 256)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['w'].value: (18, 2, 1, 1024, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value: (18, 8, 2048, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['w'].value: (18, 8, 1024, 256)@float32
['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value: (18, 2, 2048, 16384)@float32
['PaliGemma']['llm']['layers']['mlp']['linear'].value: (18, 16384, 2048)@float32
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum'].value: (18, 2, 1024, 4096)@float32
['PaliGemma']['llm']['layers']['mlp_1']['linear'].value: (18, 4096, 1024)@float32
['PaliGemma']['llm']['layers']['pre_attention_norm']['scale'].value: (18, 2048)@float32
['PaliGemma']['llm']['layers']['pre_attention_norm_1']['Dense_0']['bias'].value: (18, 3072)@float32
['PaliGemma']['llm']['layers']['pre_attention_norm_1']['Dense_0']['kernel'].value: (18, 1024, 3072)@float32
['PaliGemma']['llm']['layers']['pre_ffw_norm']['scale'].value: (18, 2048)@float32
['PaliGemma']['llm']['layers']['pre_ffw_norm_1']['Dense_0']['bias'].value: (18, 3072)@float32
['PaliGemma']['llm']['layers']['pre_ffw_norm_1']['Dense_0']['kernel'].value: (18, 1024, 3072)@float32
['action_in_proj']['bias'].value: (1024,)@float32
['action_in_proj']['kernel'].value: (32, 1024)@float32
['action_out_proj']['bias'].value: (32,)@float32
['action_out_proj']['kernel'].value: (1024, 32)@float32
['time_mlp_in']['bias'].value: (1024,)@float32
['time_mlp_in']['kernel'].value: (1024, 1024)@float32
['time_mlp_out']['bias'].value: (1024,)@float32
['time_mlp_out']['kernel'].value: (1024, 1024)@float32 (713451:train.py:255)
04:18:36.062 [I] Progress on: -/200000 rate:- remaining:? elapsed:00:00 postfix:-                 (713451:tqdm_logging.py:145)
2025-10-09 04:18:43.130630: E external/xla/xla/service/slow_operation_alarm.cc:73] Constant folding an instruction is taking > 1s:

  %reduce-window.15 = s32[256,1018]{1,0} reduce-window(%broadcast.5936, %constant.3411), window={size=1x1018 pad=0_0x1017_0}, to_apply=%region_45.13278, metadata={op_name="jit(<unnamed wrapped function>)/jit(main)/jvp(jit(cumsum))/reduce_window_sum" source_file="/iris/projects/humanoid/openpi/src/openpi/models/pi0.py" source_line=41}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2025-10-09 04:18:57.390938: E external/xla/xla/service/slow_operation_alarm.cc:140] The operation took 15.260434418s
Constant folding an instruction is taking > 1s:

  %reduce-window.15 = s32[256,1018]{1,0} reduce-window(%broadcast.5936, %constant.3411), window={size=1x1018 pad=0_0x1017_0}, to_apply=%region_45.13278, metadata={op_name="jit(<unnamed wrapped function>)/jit(main)/jvp(jit(cumsum))/reduce_window_sum" source_file="/iris/projects/humanoid/openpi/src/openpi/models/pi0.py" source_line=41}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2025-10-09 04:19:50.270396: W external/xla/xla/hlo/transforms/simplifiers/hlo_rematerialization.cc:3021] Can't reduce memory use below 71.98GiB (77289096867 bytes) by rematerialization; only reduced to 80.64GiB (86591336692 bytes), down from 81.72GiB (87741713412 bytes) originally
04:20:15.424 [I] Progress on: -/200000 rate:- remaining:? elapsed:01:39 postfix:-                 (713451:tqdm_logging.py:145)
04:20:28.071 [I] Progress on: 5.00it/200kit rate:11.4s/it remaining:634:00:16 elapsed:01:52 postfix:- (713451:tqdm_logging.py:145)
04:21:19.968 [I] Progress on: 9.00it/200kit rate:17.1s/it remaining:947:34:21 elapsed:02:43 postfix:- (713451:tqdm_logging.py:145)
04:22:18.398 [I] Progress on: 13.0it/200kit rate:20.3s/it remaining:1130:25:54 elapsed:03:42 postfix:- (713451:tqdm_logging.py:145)
04:22:29.531 [I] Progress on: 16.0it/200kit rate:9.2s/it remaining:511:48:29 elapsed:03:53 postfix:- (713451:tqdm_logging.py:145)
04:23:21.140 [I] Progress on: 17.0it/200kit rate:22.0s/it remaining:1219:59:03 elapsed:04:45 postfix:- (713451:tqdm_logging.py:145)
04:24:16.914 [I] Progress on: 21.0it/200kit rate:20.7s/it remaining:1151:03:55 elapsed:05:40 postfix:- (713451:tqdm_logging.py:145)
04:25:13.145 [I] Progress on: 25.0it/200kit rate:20.4s/it remaining:1132:54:43 elapsed:06:37 postfix:- (713451:tqdm_logging.py:145)
04:26:08.616 [I] Progress on: 29.0it/200kit rate:20.2s/it remaining:1124:21:01 elapsed:07:32 postfix:- (713451:tqdm_logging.py:145)
04:27:00.734 [I] Progress on: 33.0it/200kit rate:19.1s/it remaining:1061:27:56 elapsed:08:24 postfix:- (713451:tqdm_logging.py:145)
04:27:10.764 [I] Progress on: 34.0it/200kit rate:16.4s/it remaining:910:09:35 elapsed:08:34 postfix:- (713451:tqdm_logging.py:145)
04:27:47.929 [I] Progress on: 37.0it/200kit rate:16.2s/it remaining:897:12:04 elapsed:09:11 postfix:- (713451:tqdm_logging.py:145)
04:28:04.911 [I] Progress on: 38.0it/200kit rate:16.4s/it remaining:911:01:25 elapsed:09:28 postfix:- (713451:tqdm_logging.py:145)
04:28:43.060 [I] Progress on: 41.0it/200kit rate:16.5s/it remaining:913:57:14 elapsed:10:06 postfix:- (713451:tqdm_logging.py:145)
04:28:55.090 [I] Progress on: 42.0it/200kit rate:15.1s/it remaining:840:13:53 elapsed:10:19 postfix:- (713451:tqdm_logging.py:145)
04:29:36.931 [I] Progress on: 45.0it/200kit rate:17.1s/it remaining:951:12:36 elapsed:11:00 postfix:- (713451:tqdm_logging.py:145)
04:29:48.968 [I] Progress on: 47.0it/200kit rate:11.1s/it remaining:618:56:57 elapsed:11:12 postfix:- (713451:tqdm_logging.py:145)
04:30:28.792 [I] Progress on: 49.0it/200kit rate:17.2s/it remaining:953:54:37 elapsed:11:52 postfix:- (713451:tqdm_logging.py:145)
04:30:40.611 [I] Progress on: 51.0it/200kit rate:11.1s/it remaining:617:38:25 elapsed:12:04 postfix:- (713451:tqdm_logging.py:145)
04:31:22.340 [I] Progress on: 53.0it/200kit rate:17.7s/it remaining:984:54:54 elapsed:12:46 postfix:- (713451:tqdm_logging.py:145)
04:31:33.303 [I] Progress on: 56.0it/200kit rate:8.3s/it remaining:458:27:07 elapsed:12:57 postfix:- (713451:tqdm_logging.py:145)
04:32:12.980 [I] Progress on: 57.0it/200kit rate:17.7s/it remaining:982:00:29 elapsed:13:36 postfix:- (713451:tqdm_logging.py:145)
04:32:24.737 [I] Progress on: 59.0it/200kit rate:11.4s/it remaining:630:43:14 elapsed:13:48 postfix:- (713451:tqdm_logging.py:145)
04:33:06.487 [I] Progress on: 61.0it/200kit rate:17.9s/it remaining:991:33:42 elapsed:14:30 postfix:- (713451:tqdm_logging.py:145)
04:33:54.041 [I] Progress on: 65.0it/200kit rate:17.0s/it remaining:945:51:13 elapsed:15:17 postfix:- (713451:tqdm_logging.py:145)
04:34:05.016 [I] Progress on: 68.0it/200kit rate:8.0s/it remaining:444:59:37 elapsed:15:28 postfix:- (713451:tqdm_logging.py:145)
04:34:40.783 [I] Progress on: 69.0it/200kit rate:16.3s/it remaining:907:24:15 elapsed:16:04 postfix:- (713451:tqdm_logging.py:145)
04:34:52.539 [I] Progress on: 72.0it/200kit rate:7.9s/it remaining:438:29:48 elapsed:16:16 postfix:- (713451:tqdm_logging.py:145)
04:35:24.902 [I] Progress on: 73.0it/200kit rate:15.2s/it remaining:846:08:15 elapsed:16:48 postfix:- (713451:tqdm_logging.py:145)
04:35:36.864 [I] Progress on: 74.0it/200kit rate:14.3s/it remaining:791:34:17 elapsed:17:00 postfix:- (713451:tqdm_logging.py:145)
04:36:11.474 [I] Progress on: 77.0it/200kit rate:14.6s/it remaining:809:29:52 elapsed:17:35 postfix:- (713451:tqdm_logging.py:145)
04:36:23.620 [I] Progress on: 78.0it/200kit rate:13.8s/it remaining:769:00:30 elapsed:17:47 postfix:- (713451:tqdm_logging.py:145)
04:36:57.064 [I] Progress on: 81.0it/200kit rate:14.1s/it remaining:781:03:10 elapsed:18:21 postfix:- (713451:tqdm_logging.py:145)
04:37:13.085 [I] Progress on: 82.0it/200kit rate:14.7s/it remaining:813:38:02 elapsed:18:37 postfix:- (713451:tqdm_logging.py:145)
04:37:44.581 [I] Progress on: 85.0it/200kit rate:13.9s/it remaining:769:32:44 elapsed:19:08 postfix:- (713451:tqdm_logging.py:145)
04:38:20.937 [I] Progress on: 86.0it/200kit rate:20.6s/it remaining:1144:20:25 elapsed:19:44 postfix:- (713451:tqdm_logging.py:145)
04:38:45.949 [I] Progress on: 89.0it/200kit rate:14.0s/it remaining:775:00:34 elapsed:20:09 postfix:- (713451:tqdm_logging.py:145)
04:39:11.762 [I] Progress on: 90.0it/200kit rate:17.5s/it remaining:972:32:03 elapsed:20:35 postfix:- (713451:tqdm_logging.py:145)
04:39:34.625 [I] Progress on: 93.0it/200kit rate:12.3s/it remaining:680:15:13 elapsed:20:58 postfix:- (713451:tqdm_logging.py:145)
04:39:59.807 [I] Progress on: 94.0it/200kit rate:16.1s/it remaining:895:41:43 elapsed:21:23 postfix:- (713451:tqdm_logging.py:145)
04:40:20.208 [I] Progress on: 97.0it/200kit rate:11.0s/it remaining:612:52:32 elapsed:21:44 postfix:- (713451:tqdm_logging.py:145)
04:40:44.573 [I] Progress on: 98.0it/200kit rate:15.0s/it remaining:834:54:31 elapsed:22:08 postfix:- (713451:tqdm_logging.py:145)
[2025-10-09T04:40:57.903] error: *** JOB 12600575 ON iris-hgx-2 CANCELLED AT 2025-10-09T04:40:57 DUE to SIGNAL Terminated ***
